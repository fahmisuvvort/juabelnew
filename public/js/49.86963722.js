(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[49],{ba30:function(a,t,e){"use strict";e.r(t);var i=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("q-page",[e("q-header",[e("q-toolbar",[e("q-btn",{directives:[{name:"go-back",rawName:"v-go-back.single",modifiers:{single:!0}}],attrs:{flat:"",round:"",dense:"",icon:"arrow_back"}}),e("q-toolbar-title",[a._v("\n       Edit Produk\n      ")])],1)],1),e("q-form",{on:{submit:function(t){return t.preventDefault(),a.submit(t)}}},[e("div",{staticClass:"q-pa-md q-gutter-y-sm"},[e("q-input",{attrs:{type:"text",label:"Nama Produk",rules:[function(a){return a&&""!=a||"Nama produk harus diisi"}]},model:{value:a.form.title,callback:function(t){a.$set(a.form,"title",t)},expression:"form.title"}}),e("div",{staticClass:"row items-center q-gutter-x-sm"},[e("div",{staticClass:"col"},[e("q-input",{attrs:{mask:"#########",label:"Harga",rules:a.requiredRules},model:{value:a.form.price,callback:function(t){a.$set(a.form,"price",t)},expression:"form.price"}})],1),e("div",{staticClass:"col"},[e("q-input",{attrs:{mask:"######",label:"Stok",rules:a.requiredRules},model:{value:a.form.stock,callback:function(t){a.$set(a.form,"stock",t)},expression:"form.stock"}})],1),e("div",{staticClass:"col"},[e("q-input",{attrs:{mask:"#####",label:"Berat",suffix:"gram",rules:[function(a){return a&&a>49||"Berat harus diisi min 50 gram"}]},model:{value:a.form.weight,callback:function(t){a.$set(a.form,"weight",t)},expression:"form.weight"}})],1)]),e("div",[a.categorySelected?a._e():e("q-input",{attrs:{readonly:"",label:"Pilih Kategori"},on:{click:function(t){a.categoryModal=!0}},scopedSlots:a._u([{key:"append",fn:function(){return[e("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"edit"},on:{click:function(t){a.categoryModal=!0}}})]},proxy:!0}],null,!1,3058586195)}),a.categorySelected?e("q-input",{attrs:{readonly:"",value:a.categorySelected.title,label:"Kategori"},scopedSlots:a._u([{key:"append",fn:function(){return[e("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"close"},on:{click:a.clearCategory}})]},proxy:!0}],null,!1,579244557)}):a._e()],1),e("div",{staticClass:"q-mt-md q-mb-sm"},[e("label",{staticClass:"text-grey-7 q-pb-sm block",attrs:{for:"description"}},[a._v("Deskripsi")]),e("q-editor",{model:{value:a.form.description,callback:function(t){a.$set(a.form,"description",t)},expression:"form.description"}}),a.errors.description?e("div",{staticClass:"text-xs text-red"},[a._v(" "+a._s(a.errors.description[0]))]):a._e()],1),e("section",{staticClass:"q-my-md q-gutter-y-sm",attrs:{id:"image-section"}},[e("div",[e("q-btn",{staticClass:"mt-2 mr-2",attrs:{label:"Upload Gambar Produk",size:"sm",color:"primary",icon:"upload",type:"button"},on:{click:function(t){return t.preventDefault(),a.selectNewImage(t)}}}),e("input",{ref:"image",staticClass:"hidden",attrs:{type:"file",multiple:""},on:{change:a.updateImagePreview}})],1),e("q-list",{attrs:{separator:""}},[a._l(a.imagePreview,(function(t,i){return e("q-item",{key:i},[e("q-item-section",[e("img",{staticClass:"shadow-4 q-pa-xs bg-white",staticStyle:{width:"100px",height:"70px","object-fit":"cover"},attrs:{src:t}})]),e("q-item-section",{attrs:{side:""}},[e("q-btn",{attrs:{size:"sm",round:"",icon:"delete",glossy:"",color:"red"},on:{click:function(t){return t.preventDefault(),a.removeLocalImage(i)}}})],1)],1)})),a._l(a.oldImages,(function(t){return e("q-item",{key:t.id},[e("q-item-section",[e("img",{staticClass:"shadow-4 q-pa-xs bg-white",staticStyle:{width:"100px",height:"70px","object-fit":"cover"},attrs:{src:t.src}})]),e("q-item-section",{attrs:{side:""}},[e("q-btn",{attrs:{size:"sm",round:"",icon:"delete",glossy:"",color:"red"},on:{click:function(e){return e.preventDefault(),a.removeImage(t)}}})],1)],1)}))],2)],1)],1),e("div",{attrs:{id:"variants"}},[e("div",{staticClass:"row items-center justify-between q-mt-xl q-pa-md bg-green-1"},[e("div",{staticClass:"text-md2 text-weight-medium"},[a._v("Produk Variasi")]),a.canAddVarian?e("q-btn",{attrs:{label:"Tambah Variasi",color:"accent",size:"12px"},on:{click:function(t){a.varianModal=!0}}}):a._e()],1),a.form.varians.length?e("div",[a.form.varians[0].has_subvarian?e("div",a._l(a.form.varians,(function(t,i){return e("div",{key:i},[e("div",{staticClass:"row items-start justify-between bg-grey-2 q-pa-md q-pt-lg"},[e("div",{staticClass:"text-weight-bold text-md"},[a._v(a._s(a.form.varians[i].label)+" "+a._s(a.form.varians[i].value))]),e("div",{staticClass:"q-gutter-x-sm"},[e("q-btn",{attrs:{unelevated:"",size:"10px",color:"red"},on:{click:function(t){return a.deleteVarian(i)}}},[a._v("Hapus "+a._s(a.form.varians[i].value))]),e("q-btn",{attrs:{unelevated:"",size:"10px",color:"teal"},on:{click:function(t){return a.pushSubVarian(i)}}},[a._v("Tambah Item")])],1)]),e("div",{},[a.form.varians[i].subvarian.length?e("q-list",{staticClass:"bg-white q-pa-sm q-mt-xs"},a._l(a.form.varians[i].subvarian,(function(t,r){return e("q-item",{key:r,staticClass:"q-px-sm"},[e("q-item-section",{attrs:{side:""}},[e("q-btn",{attrs:{round:"",unelevated:"",padding:"2px",icon:"remove",size:"9px",color:"red"},on:{click:function(t){return a.deleteSubvarian(i,r)}}})],1),e("q-item-section",[e("q-input",{attrs:{"stack-label":"",filled:"",square:"",required:"",dense:"",label:a.form.varians[i].subvarian[r].label},model:{value:a.form.varians[i].subvarian[r].value,callback:function(t){a.$set(a.form.varians[i].subvarian[r],"value",t)},expression:"form.varians[varIndex].subvarian[subIndex].value"}})],1),e("q-item-section",[e("q-input",{attrs:{"stack-label":"",filled:"",square:"",required:"",dense:"",label:"Tambahan Harga",mask:"###########"},model:{value:a.form.varians[i].subvarian[r].price,callback:function(t){a.$set(a.form.varians[i].subvarian[r],"price",t)},expression:"form.varians[varIndex].subvarian[subIndex].price"}})],1),e("q-item-section",[e("q-input",{attrs:{"stack-label":"",filled:"",square:"",required:"",dense:"",label:"Stok",mask:"######"},model:{value:a.form.varians[i].subvarian[r].stock,callback:function(t){a.$set(a.form.varians[i].subvarian[r],"stock",t)},expression:"form.varians[varIndex].subvarian[subIndex].stock"}})],1)],1)})),1):a._e()],1)])})),0):e("div",[e("div",{staticClass:"row items-start justify-between bg-grey-2 q-pa-md q-pt-lg"},[e("div",{staticClass:"text-weight-bold text-md"},[a._v(a._s(a.form.varians[0].label)+" ")]),e("div",{staticClass:"q-gutter-x-sm"},[e("q-btn",{attrs:{unelevated:"",size:"10px",color:"teal"},on:{click:a.pushVarian}},[a._v("Tambah Item")])],1)]),e("q-list",[e("q-list",{staticClass:"bg-white q-pa-sm q-mt-xs"},a._l(a.form.varians,(function(t,i){return e("q-item",{key:i},[e("q-item-section",{attrs:{side:""}},[e("q-btn",{attrs:{round:"",unelevated:"",padding:"2px",icon:"remove",size:"9px",color:"red"},on:{click:function(t){return a.deleteVarian(i)}}})],1),e("q-item-section",[e("q-input",{attrs:{"stack-label":"",filled:"",square:"",required:"",dense:"",label:a.form.varians[i].label},model:{value:a.form.varians[i].value,callback:function(t){a.$set(a.form.varians[i],"value",t)},expression:"form.varians[vIndex].value"}})],1),e("q-item-section",[e("q-input",{attrs:{"stack-label":"",filled:"",square:"",required:"",dense:"",label:"Tambahan Harga",mask:"###########"},model:{value:a.form.varians[i].price,callback:function(t){a.$set(a.form.varians[i],"price",t)},expression:"form.varians[vIndex].price"}})],1),e("q-item-section",[e("q-input",{attrs:{"stack-label":"",filled:"",square:"",required:"",dense:"",label:"Stok",mask:"######"},model:{value:a.form.varians[i].stock,callback:function(t){a.$set(a.form.varians[i],"stock",t)},expression:"form.varians[vIndex].stock"}})],1)],1)})),1)],1)],1)]):a._e()]),e("q-footer",[e("q-btn",{staticClass:"full-width",attrs:{type:"submit",loading:a.loading,label:"Simpan Data"}},[e("q-tooltip",{staticClass:"bg-accent"},[a._v("Simpan Data")])],1)],1)],1),e("q-dialog",{model:{value:a.varianModal,callback:function(t){a.varianModal=t},expression:"varianModal"}},[e("q-card",{staticClass:"card-medium"},[e("div",{staticClass:"card-heading"},[a._v("Tambah varian")]),e("q-form",{on:{submit:function(t){return t.preventDefault(),a.addVarianProduk(t)}}},[e("q-card-section",[e("div",[e("div",{staticClass:"text-md"},[a._v("Varian")]),e("q-input",{attrs:{label:"Label",placeholder:"contoh: Ukuran"},model:{value:a.tempVarian.label,callback:function(t){a.$set(a.tempVarian,"label",t)},expression:"tempVarian.label"}}),e("q-input",{attrs:{label:"Item",placeholder:"contoh: Small, Medium, Large"},model:{value:a.tempVarian.value,callback:function(t){a.$set(a.tempVarian,"value",t)},expression:"tempVarian.value"}}),e("div",{staticClass:"text-grey-7 text-xs q-py-xs"},[a._v("Untuk multiple item, gunakan sparator koma")])],1),a.canToggleSubvarian?e("div",[e("q-checkbox",{attrs:{label:"Subvarian?"},model:{value:a.form.has_subvarian,callback:function(t){a.$set(a.form,"has_subvarian",t)},expression:"form.has_subvarian"}})],1):a._e(),a.mustHaveSubvarian?e("div",{staticClass:"q-mt-md"},[e("div",{staticClass:"text-md"},[a._v("Subvarian")]),e("q-input",{attrs:{label:"Label",placeholder:"contoh: Warna"},model:{value:a.tempSubvarian.label,callback:function(t){a.$set(a.tempSubvarian,"label",t)},expression:"tempSubvarian.label"}}),e("q-input",{attrs:{label:"Item",placeholder:"contoh: Merah, Biru, Ungu"},model:{value:a.tempSubvarian.value,callback:function(t){a.$set(a.tempSubvarian,"value",t)},expression:"tempSubvarian.value"}}),e("div",{staticClass:"text-grey-7 text-xs q-py-xs"},[a._v("Untuk multiple item, gunakan sparator koma")])],1):a._e(),e("div",{staticClass:"flex justify-end q-mt-md q-gutter-sm"},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Tutup",flat:"",color:"primary"}}),e("q-btn",{attrs:{unelevated:"",label:"Tambah",type:"submit",color:"primary"}})],1)])],1)],1)],1),e("q-dialog",{model:{value:a.categoryModal,callback:function(t){a.categoryModal=t},expression:"categoryModal"}},[e("q-card",{staticStyle:{"max-width":"450px",width:"90%"}},[e("div",{staticStyle:{height:"350px","overflow-y":"auto"}},[e("div",[e("div",{staticClass:"bg-white relative"},[e("category-block",{ref:"category",attrs:{selectable:"",categories:a.categories.data},on:{onClear:a.clearCategory,onClose:function(t){a.categoryModal=!1},onSelect:a.selectCategory}})],1)])]),e("q-card-actions",{staticClass:"justify-end"},[e("q-btn",{attrs:{flat:"",label:"Batal",color:"dark"},on:{click:function(t){a.categoryModal=!1}}})],1)],1)],1)],1)},r=[],s=e("ded3"),n=e.n(s),o=(e("4de4"),e("a434"),e("ac1f"),e("1276"),e("159b"),e("a4d3"),e("e01a"),e("d3b7"),e("e6cf"),e("a79d"),e("7db0"),e("2f62")),l=e("391e"),c={components:{CategoryBlock:l["a"]},name:"ProductFormEdit",data:function(){return{varianModal:!1,tempVarian:{label:"",value:""},tempSubvarian:{label:"",value:"",stock:"",is_preorder:!1,price:"",sku:"twetwetwet",items:""},requiredRules:[function(a){return a&&a.length>0||"Field harus diisi."}],product:null,form:{id:"",title:"",price:"",weight:"",stock:"",category_id:"",description:"",varians:[],images:[],del_images:[],has_subvarian:!1},imagePreview:[],oldImages:[],variantModalForm:!1,productOldImages:[],chatOptions:[],categoryModal:!1,categorySelected:null}},computed:{user:function(){return this.$store.state.user.user},errors:function(){return this.$store.state.errors},loading:function(){return this.$store.state.loading},categories:function(){return this.$store.state.category.categoryAll},canToggleSubvarian:function(){return!this.form.varians.length||!this.form.varians[0].has_subvarian},mustHaveSubvarian:function(){return!(!this.form.varians.length||!this.form.varians[0].has_varian)||!!this.form.has_subvarian},canAddVarian:function(){return!(this.form.varians.length&&!this.form.varians[0].has_subvarian)}},methods:n()(n()(n()({},Object(o["b"])("product",["productUpdate","getProductById"])),Object(o["b"])("category",["getCategories","getAllCategories"])),{},{onUpdateImage:function(a){this.form.product_images.push(a)},selectCategory:function(a){this.categorySelected=a,this.form.category_id=a.id,this.categoryModal=!1},clearCategory:function(){this.form.category_id="",this.categorySelected=null},onDeleteProductOldImage:function(a){this.productOldImages=this.productOldImages.filter((function(t){return t.filename!=a})),this.form.del_product_images.push(a)},onDeleteImage:function(a){this.form.product_images.splice(a,1)},deleteVarian:function(a){var t=this;this.$q.dialog({title:"Yakin akan menghapus data?",cancel:!0}).onOk((function(){t.form.varians.splice(a,1)}))},deleteSubvarian:function(a,t){this.form.varians[a].subvarian.splice(t,1),this.form.varians[a].subvarian.length||this.form.varians.splice(a,1)},pushSubVarian:function(a){var t=this.form.varians[a],e={label:t.subvarian[0].label,value:"",stock:0,sku:this.generateSku(8),price:0};this.form.varians[a].subvarian.push(e)},pushVarian:function(){this.form.varians.push({has_subvarian:!1,label:this.form.varians[0].label,value:"",stock:0,sku:this.generateSku(13),price:0})},addVarianProduk:function(){var a=this,t=this.tempVarian.value.split(",");this.form.has_subvarian?t.forEach((function(t){var e=null;e={has_subvarian:!0,label:a.tempVarian.label,value:t,subvarian:[]};var i=a.tempSubvarian.value.split(",");i.forEach((function(t){var i={label:a.tempSubvarian.label,value:t,stock:0,sku:a.generateSku(16),price:0};e.subvarian.push(i)})),a.form.varians.push(e)})):t.forEach((function(t){var e=null;e={has_subvarian:!1,label:a.tempVarian.label,value:t,stock:0,sku:a.generateSku(7),price:0},a.form.varians.push(e)})),this.varianModal=!1},handleAddVarian:function(){this.varianModal=!0},submit:function(){var a=this,t=new FormData;if(t.append("id",this.form.id),t.append("title",this.form.title),t.append("price",this.form.price),t.append("weight",this.form.weight),t.append("has_subvarian",this.form.has_subvarian),t.append("stock",this.form.stock),t.append("description",this.form.description),this.form.category_id&&t.append("category_id",this.form.category_id),this.form.varians.length&&t.append("varians",JSON.stringify(this.form.varians)),this.form.images.length>0)for(var e=0;e<this.form.images.length;e++){var i=this.form.images[e];t.append("images["+e+"]",i)}if(this.form.del_images.length>0)for(var r=0;r<this.form.del_images.length;r++){var s=this.form.del_images[r];t.append("del_images["+r+"]",s)}this.productUpdate(t).then((function(){"seller"==a.user.role?(a.$store.dispatch("seller/getProducts"),a.$router.push({name:"SellerProduct"})):(a.$store.dispatch("product/getAdminProducts"),a.$router.push({name:"AdminProductIndex"}))})).finally((function(){return a.$store.commit("SET_LOADING",!1)}))},selectNewImage:function(){this.$refs.image.click()},updateImagePreview:function(){for(var a=this,t=this.$refs.image.files,e=0;e<t.length;e++){this.form.images.push(t[e]);var i=new FileReader;i.onload=function(t){a.imagePreview.push(t.target.result)},i.readAsDataURL(t[e])}},removeLocalImage:function(a){this.imagePreview=this.imagePreview.filter((function(t,e){return e!==a})),this.form.images=this.form.images.filter((function(t,e){return e!==a}))},removeImage:function(a){this.oldImages=this.oldImages.filter((function(t){return t.id!==a.id})),this.form.del_images.push(a.filename)},setData:function(){var a=this;this.form.id=this.product.id,this.form.title=this.product.title,this.form.price=this.product.price,this.form.weight=this.product.weight,this.form.stock=this.product.stock,this.form.category_id=this.product.category_id,this.form.description=this.product.description,this.form.varians=this.product.varians,this.form.has_subvarian=!!this.product.varians.length&&this.product.varians[0].has_subvarian,this.oldImages=this.product.assets,this.form.category_id&&(this.categorySelected=this.categories.data.find((function(t){return t.id==a.form.category_id})))}}),mounted:function(){var a=this;this.getProductById(this.$route.params.id).then((function(t){a.product=t.data.results,a.setData()})),this.getAllCategories()}},u=c,d=e("2877"),m=e("9989"),v=e("e359"),f=e("65c6"),p=e("9c40"),h=e("6ac5"),b=e("0378"),g=e("27f9"),k=e("d66b"),q=e("1c1c"),y=e("66e5"),x=e("4074"),_=e("7ff0"),w=e("05c0"),C=e("24e8"),S=e("f09f"),I=e("a370"),$=e("8f8e"),V=e("4b7e"),P=e("2eeb"),M=e("7f67"),Q=e("eebe"),D=e.n(Q),T=Object(d["a"])(u,i,r,!1,null,null,null);t["default"]=T.exports;D()(T,"components",{QPage:m["a"],QHeader:v["a"],QToolbar:f["a"],QBtn:p["a"],QToolbarTitle:h["a"],QForm:b["a"],QInput:g["a"],QEditor:k["a"],QList:q["a"],QItem:y["a"],QItemSection:x["a"],QFooter:_["a"],QTooltip:w["a"],QDialog:C["a"],QCard:S["a"],QCardSection:I["a"],QCheckbox:$["a"],QCardActions:V["a"]}),D()(T,"directives",{GoBack:P["a"],ClosePopup:M["a"]})}}]);