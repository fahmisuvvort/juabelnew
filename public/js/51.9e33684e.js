(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[51],{d09f:function(t,e,o){"use strict";o.r(e);var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("q-page",[o("q-header",[o("q-toolbar",[o("q-btn",{attrs:{to:{name:"PromoIndex",query:{q:"promo"}},flat:"",round:"",dense:"",icon:"arrow_back"}}),t.promo?o("q-toolbar-title",[t._v("\n       Produk Promo \n      ")]):t._e()],1)],1),o("div",{staticClass:"q-pa-md"},[t.promo?o("div",{staticClass:"q-mb-sm"},[o("div",{staticClass:"text-lg text-weight-bold"},[t._v(t._s(t.promo.label))])]):t._e(),t.promo?o("div",{},[o("table",{staticClass:"table full-width bordered"},[o("tr",[o("th",{attrs:{align:"left"}},[t._v("Label")]),o("th",{attrs:{align:"right"}},[t._v(t._s(t.promo.label))])]),o("tr",[o("th",{attrs:{align:"left"}},[t._v("Start")]),o("td",{attrs:{align:"right"}},[t._v(t._s(t.promo.start))])]),o("tr",[o("th",{attrs:{align:"left"}},[t._v("Selesai")]),o("td",{attrs:{align:"right"}},[o("div",[t._v(t._s(t.promo.end))]),o("div",{staticClass:"text-grey-7 text-caption"},[t._v("( "+t._s(t.promo.diff_end)+" )")])])]),o("tr",[o("th",{attrs:{align:"left"}},[t._v("Status")]),o("td",{attrs:{align:"right"}},[o("span",{staticClass:"q-px-md q-py-xs rounded-borders text-white",class:t.promo.is_active?"bg-green":"bg-grey-7"},[t._v(t._s(t.promo.is_active?"Active":"Inactive"))])])])])]):t._e()]),t.promo?o("div",{staticClass:"q-mt-lg"},[o("div",{staticClass:"row items-center justify-between q-pa-md"},[o("div",{staticClass:"text-md"},[t._v("Produk Total "+t._s(t.products.length))]),o("div",{staticClass:"row items-center q-gutter-x-sm"},[o("q-btn",{attrs:{unelevated:"",color:"accent"},on:{click:t.handleAddProductPromo}},[o("q-icon",{attrs:{name:"add"}}),o("span",[t._v("Produk")])],1)],1)]),o("div",{staticClass:"q-mt-md"},[t.products.length?o("q-list",{attrs:{separator:""}},[o("q-item",[o("q-item-section",{attrs:{side:""}},[t._v("#")]),o("q-item-section",[t._v("Nama")]),o("q-item-section",[t._v("Diskon")]),o("q-item-section",{attrs:{side:""}},[t._v("Actions")])],1),t._l(t.products,(function(e,i){return o("q-item",{key:i},[o("q-item-section",{attrs:{side:""}},[t._v(t._s(i+1))]),o("q-item-section",[t._v(t._s(e.title))]),o("q-item-section",[t._v(t._s("PERCENT"==e.pivot.discount_type?e.pivot.discount_amount+" %":t.moneyIDR(e.pivot.discount_amount)))]),o("q-item-section",{attrs:{side:""}},[o("q-btn",{attrs:{icon:"delete",padding:"4px",size:"sm",unelevated:"",color:"red",disabled:t.syncLoading},on:{click:function(o){return t.handleRemoveProductPromo(e.id)}}})],1)],1)}))],2):t._e()],1)]):t._e(),o("q-dialog",{attrs:{persistent:""},model:{value:t.searchModal,callback:function(e){t.searchModal=e},expression:"searchModal"}},[o("q-card",{staticClass:"card-medium"},[o("div",{staticClass:"flex justify-between items-center card-heading"},[o("div",{},[t._v(" Produk Promo")]),o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"close",round:"",padding:"0px",flat:""}})],1),o("q-card-section",{staticClass:"q-gutter-y-sm",staticStyle:{"min-height":"150px","max-height":"400px","overflow-y":"auto"}},[t.productSearch.length?o("div",[o("q-list",{attrs:{separator:""}},t._l(t.productSearch,(function(e){return o("q-item",{key:e.id,attrs:{clickable:""},on:{click:function(o){return t.syncProduct(e)}}},[o("q-item-section",{attrs:{side:""}},[o("q-btn",{attrs:{icon:"check_box",padding:"0px",unelevated:"",size:"12px"}})],1),o("q-item-section",[t._v(t._s(e.title))])],1)})),1)],1):t._e(),o("q-inner-loading",{attrs:{showing:t.isLoading}}),t.isLoading||t.productSearch.length?t._e():o("div",{staticClass:"text-center q-pt-lg"},[t._v("Tidak ada data ditemukan")])],1)],1)],1),o("q-dialog",{attrs:{persistent:""},model:{value:t.productPromoModal,callback:function(e){t.productPromoModal=e},expression:"productPromoModal"}},[t.productSelected?o("q-card",{staticClass:"card-medium"},[o("q-card-section",[o("div",{staticClass:"text-md text-weight-bold q-mb-md"},[t._v("Produk "+t._s(t.productSelected.title))]),o("q-form",{on:{submit:function(e){return e.preventDefault(),t.submitProductPromo(e)}}},[o("div",{staticClass:"flex items-center q-mt-sm full-width q-gutter-x-sm"},[o("q-input",{staticClass:"col",attrs:{required:"",filled:"",square:"",label:"Diskon Nominal",rules:[function(t){return!!t||"Field is required"}]},model:{value:t.form.discount_amount,callback:function(e){t.$set(t.form,"discount_amount",e)},expression:"form.discount_amount"}}),o("q-select",{staticClass:"col",attrs:{required:"",filled:"",square:"",label:"Diskon Tipe",options:t.discountTypeOptions,"emit-value":"","map-options":"",rules:[function(t){return!!t||"Field is required"}]},model:{value:t.form.discount_type,callback:function(e){t.$set(t.form,"discount_type",e)},expression:"form.discount_type"}})],1),o("div",{staticClass:"flex justify-end q-gutter-x-sm q-mt-md"},[o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",outline:"",color:"primary"}}),o("q-btn",{attrs:{type:"submit",label:"Submit",unelevated:"",color:"primary"}})],1)])],1)],1):t._e()],1)],1)},a=[],s=(o("d3b7"),o("e6cf"),o("a79d"),o("ac1f"),o("841c"),o("758b")),r={name:"ProductPromo",data:function(){return{productPromoModal:!1,productSelected:null,product_ids:[],promo:null,isLoading:!1,syncLoading:!1,searchModal:!1,search:"",productSearch:[],products:[],form:{promo_id:null,product_id:null,discount_amount:0,discount_type:"PERCENT"},discountTypeOptions:[{value:"PERCENT",label:"Persen"},{value:"AMOUNT",label:"Nominal"}],removeId:null}},methods:{getPromoDetail:function(){var t=this;Object(s["a"])().get("getPromoDetail/"+this.$route.params.id).then((function(e){200==e.status&&(t.products=e.data.results.products,t.promo=e.data.results.promo)}))},getProductPromo:function(){var t=this;Object(s["a"])().get("getProductPromo/"+this.$route.params.id).then((function(e){200==e.status&&(t.products=e.data.results)}))},findProduct:function(){var t=this;this.isLoading=!0,this.productSearch=[],Object(s["a"])().get("findProductWithoutPromo").then((function(e){200==e.status&&(t.productSearch=e.data.results)})).finally((function(){t.isLoading=!1}))},handleAddProductPromo:function(){this.search="",this.searchModal=!0,this.productSearch=[],this.findProduct()},syncProduct:function(t){this.productSelected=t,this.form.product_id=t.id,this.form.promo_id=this.promo.id,this.searchModal=!1,this.productPromoModal=!0},submitProductPromo:function(){var t=this;"PERCENT"==this.form.discount_type&&(0==this.form.discount_amount||this.form.discount_amount>=99)?this.$q.notify({type:"negative",message:"Tentukan nilai nominal diskon dengan benar"}):Object(s["a"])().post("submitProductPromo",this.form).then((function(){t.getProductPromo()})).finally((function(){return t.productPromoModal=!1}))},handleRemoveProductPromo:function(t){var e=this;this.removeId=t,this.$q.dialog({title:"Yakin akan menghapus data?",cancel:!0}).onOk((function(){e.removeProductPromo()}))},removeProductPromo:function(){var t=this;Object(s["a"])().post("removeProductPromo",{promo_id:this.promo.id,product_id:this.removeId}).then((function(){return t.getProductPromo()}))}},mounted:function(){this.getPromoDetail()}},n=r,d=o("2877"),c=o("9989"),l=o("e359"),u=o("65c6"),m=o("9c40"),p=o("6ac5"),h=o("0016"),v=o("1c1c"),f=o("66e5"),_=o("4074"),g=o("24e8"),q=o("f09f"),P=o("a370"),b=o("74f7"),y=o("0378"),x=o("27f9"),k=o("ddd8"),C=o("7f67"),w=o("eebe"),S=o.n(w),Q=Object(d["a"])(n,i,a,!1,null,null,null);e["default"]=Q.exports;S()(Q,"components",{QPage:c["a"],QHeader:l["a"],QToolbar:u["a"],QBtn:m["a"],QToolbarTitle:p["a"],QIcon:h["a"],QList:v["a"],QItem:f["a"],QItemSection:_["a"],QDialog:g["a"],QCard:q["a"],QCardSection:P["a"],QInnerLoading:b["a"],QForm:y["a"],QInput:x["a"],QSelect:k["a"]}),S()(Q,"directives",{ClosePopup:C["a"]})}}]);